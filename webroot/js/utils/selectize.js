define(["require","jquery","selectize"],function(e){var t=e("jquery"),n=e("selectize"),r=t("[data-selectize]"),i=r.closest("form"),s=r.data("selectize"),o=r.data("url");r.selectize({valueField:"id",labelField:s,searchField:[s],maxOptions:10,options:[],create:!1,render:{option:function(t,n){return"<div>"+n(t[s])+"</div>"}},load:function(n,r){data={},data[s]=n,t.ajax({url:o,dataType:"json",data:data,error:function(){console.log("error fetching "+s+" from "+o),r()},success:function(t){r(t.data)}})}}),i.submit(function(){var e=r.val().split(",");e.forEach(function(e){t("<input />").attr("type","hidden").attr("name",r.attr("name")+"[]").attr("value",e).appendTo(i)}),r.remove()})});